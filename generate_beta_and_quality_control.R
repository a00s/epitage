library(GEOquery)
library(sesame)
getGEOSuppFiles("GSM2333901")
gunzip("GSM2333901/GSM2333901_9370847096_R05C02_Grn.idat.gz", overwrite = TRUE, remove = TRUE)
gunzip("GSM2333901/GSM2333901_9370847096_R05C02_Red.idat.gz", overwrite = TRUE, remove = TRUE)
s = readIDATpair("GSM2333901/GSM2333901_9370847096_R05C02")
betas = openSesame(s, BPPARAM = BiocParallel::MulticoreParam(2))
betas3 <- data.matrix(betas, rownames.force = NA)
betas3 <- cbind("cpg" = rownames(betas3), data.frame("beta"=betas3, row.names=NULL))
write.table(betas3, file="GSM2333901/betas.txt", row.names=FALSE, col.names=FALSE)
inferSex(s)
inferEthnicity(s)
predictAgeHorvath353(betas)

